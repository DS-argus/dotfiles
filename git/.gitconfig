[user]
	name = argus
	email = tjdals4047@gmail.com

[http]
	postBuffer = 2147483648

[credential]
  helper = store

[init]
	defaultBranch = main

[alias]
  # https://github.com/johngrib/dotfiles/blob/master/.gitconfig
  alias-basic = "!#-----------------------------------------------------------------------;\n\
    git alias | head -7"
  ci = commit
  co = checkout
  sw = switch
  re = restore
  ss = status
  s = status -s

  alias-log = "!#------------------------------------------------------------------------;\n\
    git alias | egrep 'log|commit-'"

  commit-select = "!# git log 그래프에서 commit 한 개를 선택.;\n\
      git l \
      | fzf -m --ansi --layout=reverse --preview=\"echo {} | sed 's/^[*| ]*//g' | cut -d' ' -f1 | xargs git show --color=always \" \
      | sed 's/^[*| ]*//g' | cut -d' ' -f1"
  c-s = "!git commit-select"

  commit-copy = "!# git log 그래프에서 commit 한 개를 선택하면 시스템 클립보드로 복사.;\n\
      git commit-select | tr -d '\n' | pbcopy && echo Copied: `pbpaste`;"
  c-c = "!git commit-copy"

  l = "!# log 형태 : 커밋 그래프 + 짧은 해시 + 메시지 + 날짜(ago) + 작성자.;\n\
      git log \
      --color --graph --decorate \
      --date=format:'%Y-%m-%d' \
      --abbrev-commit \
      --pretty=format:'%C(red)%h%C(auto)%d %s %C(green)(%cr)%C(bold blue) %an'"

  ld = "!# log 형태 : 커밋 그래프 + 짧은 해시 + 메시지 + 날짜/시간 + 작성자.;\n\
      git log \
      --color --graph --decorate \
      --date=format:'%Y-%m-%d %H:%M:%S' \
      --abbrev-commit \
      --pretty=format:'%C(red)%h%C(auto)%d %s %C(green)(%ad)%C(bold blue) %an'"

  ll = "!# log 형태 : 커밋 그래프 + 전체 해시 + 메시지 + 날짜(ago) + 작성자.;\n\
      git log \
      --color --graph --decorate \
      --date=format:'%Y-%m-%d' \
      --abbrev-commit \
      --pretty=format:'%C(red)%H%C(auto)%d %s %C(green)(%cr)%C(bold blue) %an'"

  lld = "!# log 형태 : 커밋 그래프 + 전체 해시 + 메시지 + 날짜/시간 + 작성자.;\n\
      git log \
      --color --graph --decorate \
      --date=format:'%Y-%m-%d %H:%M:%S' \
      --abbrev-commit \
      --pretty=format:'%C(red)%H%C(auto)%d %s %C(green)(%ad)%C(bold blue) %an'"

  lh = "!# 최근 25개의 커밋 log 출력.;\n\
        git l | head -25"

  lf = "!# 주어진 file의 log history를 출력.;\n\
      fzf --preview=\"bat {}\" | xargs git l --follow"

  lfp = "!# 주어진 file의 log history를 자세히 출력.;\n\
      fzf --preview=\"bat {}\" | xargs git l --follow -p"

  all = "!# GC orphan 커밋까지 포함한 전체 커밋 log 출력.;\n\
      _() { git log --oneline --graph --reflog $(git fsck --unreachable | perl -ne 'print \"$1\\n\" if /^\\w+ commit ([0-9a-f]+)$/'); }; _"

  alias-branch = "!#------------------------------------------------------------------------------;\n\
      git alias | egrep '[bB]ranch'"

  b0 = "!# 작업 branch를 출력.;\n\
      git branch --show-current"

  b1 = "!# 이전 branch를 출력.;\n\
      git rev-parse --abbrev-ref @{-1}"

  back = "!# 현재 작업중인 branch를 백업.;\n\
      echo created new branch: backup-`git b0`;\
      git branch backup-`git b0`"

  bb = "!# branch 도구 모음. 도움말: 'git bb help';\n\
      f() { \n\
          if [ $# = 0 ]; then \
              git branch-select | xargs git checkout; \
          elif [ $1 = 'help' ]; then \
              echo 'git bb           : Select and checkout branch'; \
              echo 'git bb c, clean  : Clean all merged branches'; \
              echo 'git bb d, D      : Delete seleted branches(D: force)'; \
              echo 'git bb l, list   : List branches excluding the current branch'; \
              echo 'git bb m, merged : List merged branches excluding the current and master branches'; \
          elif [ $1 = 'd' -o $1 = 'D' ]; then \
              git branch -$1 $(git bb list | fzf -m | awk '{print $2}'); \
          elif [ $1 = 'clean' -o $1 = 'c' ]; then \
              git branch-clean; \
          elif [ $1 = 'list' -o $1 = 'l' ]; then \
              git branch-list; \
          elif [ $1 = 'merged' -o $1 = 'm' ]; then \
              git branch-merged; \
          elif [ $1 = 'select' -o $1 = 's' ]; then \
              git branch-select; \
          else \
              git bb help; \
          fi; \
      }; f"

  branch-clean = "!# 선택한 여러 branch들을 삭제.;\n\
      curr_hash=`git show -s | head -1 | cut -d ' ' -f2`; \
      for branch in `find .git/refs -type f | fzf --ansi -m --preview=\"cat {} | xargs git l\"` ; do \
          hash=`cat $branch`; \
          if [ $hash = $curr_hash ]; then \
              continue; \
          fi; \
          git ll | egrep $hash -C 1; \
          read -p \"Delete $branch? [y|n] \" -r; \
          REPLY=${REPLY:-"n"}; \
          if [ $REPLY = \"y\" ]; then \
              rm $branch; \
              echo \"\\033[32m$branch \\033[0mhas been\\033[31m deleted\\033[0m.\n\"; \
          fi; \
      done"
  b-c = "!git branch-clean"

  branch-list = "!# branch 목록을 출력.;\n\
      git for-each-ref --sort=-committerdate refs/heads --format='%(HEAD) %(refname:strip=2) | %(committerdate:relative) | %(authorname)' \
      | column -ts'|' \
      | sed 's/^ /./'"
  b-l = "!git branch-list"

  branch-list-all = "!# 모든 브랜치 목록을 출력.;\n\
      for branch in `git branch -r --merged | grep -v HEAD`; do echo `git show --format=\"%ci ; %cr ; %an ;\" $branch | head -n 1` $branch; done | sort -r | column -ts';'"
  b-la = "!git branch-list-all"

  branch-select = "!# branch 하나를 선택.;\n\
      f() { \
          _height=$(stty size | awk '{print $1}');\
          git branch-list | fzf -m --preview \"git l {2} | head -n $_height\" | awk '{print $2}'; \
      }; f"
  b-s = "!git branch-select"

  ch = "!# branch 선택하고 이동.;\n\
    git branch-select | xargs git checkout"

  alias-stage = "!#-------------------------------------------------------------------------;\n\
      git alias | egrep '(add|diff|stage)' -i"

  a = "!# 변경된 파일 중 일부를 선택적으로 add.;\n\
      git diff-select | xargs git add"

  diff-select = "!# 변경된 파일 목록 중 일부만 fzf로 선택해서 git add.;\n\
      f() { \
          _height=$(stty size | awk '{print $1}');\
          git diff-info \
          | fzf -m --header \"$(git diff --shortstat)\" --preview \
              \"if [[ {1} == '??' ]]; then cat {3}; else git diff {3}; fi \
              | head -n $_height \
              | pygmentize\" \
          | awk '{print $3}'; \
      }; f"

  diff-info = "!# 변경된 파일들의 +, - 수치 요약을 컬럼 형태로 출력.;\n\
      fileA=/tmp/git-s-$(uuidgen); \
      fileB=/tmp/git-diff-$(uuidgen); \
      git s | awk '{print $2,$1}' > $fileA; \
      git diff --numstat | awk '{print $3,$1,$2}' > $fileB; \
      join -t' ' -a 1 $fileA $fileB | awk '{print $2, \"(+\"$3 \",-\"$4\")\", $1}' | sed 's/(+,-)/./' | column -t -s' ' ; \
      rm -f $fileA $fileB; \
  "

  alias-alias = "!#----------------------------------------------------------------------------;\n\
    git alias | grep alias"

  alias = "!# 모든 alias 출력.;\n\
    git config --list \
    | egrep '^alias.+' \
    | sed -e 's/^alias\\.//' \
    | sed -e 's/^[^=]*=/\\'$'\\033[31m&\\033[(B\\033[m/' \
    | column -t -s'=' \
    | sed 's/!#* *//; s/;$//' \
    | cut -c1-85"

[core]
	quotepath = false
